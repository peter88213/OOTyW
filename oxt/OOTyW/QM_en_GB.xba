<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="QM_en_GB" script:language="StarBasic">REM  *****  BASIC  *****
&apos; ----------------------------------------------------------------------
&apos; Do conversions according to BE conventions.
&apos; ----------------------------------------------------------------------



sub Main
&apos; ----------------------------------------------------------------------
&apos; Replace keyboard glyphs by typographical correct glyphs.
&apos; ----------------------------------------------------------------------

Common.Em_dash
Common.Main
SmartQuotes
ProtectQM

end sub



sub SmartQuotes
&apos; ----------------------------------------------------------------------
&apos; Replace primes by BE style quotation marks.
&apos; ----------------------------------------------------------------------

Common.SmartQuotes(&quot;“&quot;,&quot;”&quot;,&quot;‘&quot;,&quot;’&quot;)

end sub



Sub TypewriterView
&apos; ----------------------------------------------------------------------
&apos; Go back to &quot;typewriter&quot; style.
&apos; ----------------------------------------------------------------------
Dim AOldStr(2) As String
Dim ANewStr(2) As String

AOldStr() = Array(&quot;([:alpha:])’([:alpha:])&quot;,&quot; ’&quot;,&quot;[“”]&quot;,&quot;[‘’]&quot;)
ANewStr() = Array(&quot;$1&apos;$2&quot;,&quot; &apos;&quot;,&quot;&apos;&quot;,CHR$(34))

sar(AOldStr,ANewStr,True)

Revert.Ellipsis
Revert.Em_dash
Revert.UnprotectQM

End Sub



Sub ProtectQM
&apos; ----------------------------------------------------------------------
&apos; Prevent hyphenation around quotation marks.
&apos; ----------------------------------------------------------------------

Common.ProtectQM(&quot;‘&quot;,&quot;’&quot;)

End Sub



Sub UnprotectQM
&apos; ----------------------------------------------------------------------
&apos; Allow hyphenation around quotation marks.
&apos; ----------------------------------------------------------------------

Common.UnprotectQM(&quot;‘&quot;,&quot;’&quot;)

End Sub


sub ShowDirectSpeech
&apos; ----------------------------------------------------------------------
&apos; De-emphasize all but direct speech.
&apos; ----------------------------------------------------------------------

&apos; ----------------------------------------------------------------------
&apos; Hide apostrophes not to be confused with quotes

Dim AOldStr(0) As String
Dim ANewStr(0) As String

AOldStr() = Array(&quot;([:alpha:])’([:alpha:])&quot;)
ANewStr() = Array(&quot;$1&apos;$2&quot;)

sar(AOldStr,ANewStr,True)

&apos; ----------------------------------------------------------------------
&apos; colorize non-direct-speech 

Common.ShowDirectSpeech(&quot;‘[^‘]+’&quot;)

&apos; ----------------------------------------------------------------------
&apos; Restore apostrophes

Common.Apostrophe

end sub



sub StandardView
&apos; ----------------------------------------------------------------------
&apos; Set all text to default color.
&apos; ----------------------------------------------------------------------

Common.StandardView

end sub






</script:module>