<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="QM_en_US" script:language="StarBasic">REM  *****  BASIC  *****


sub Main
&apos; ----------------------------------------------------------------------
&apos; Replace keyboard glyphs by typographical correct glyphs
&apos; ----------------------------------------------------------------------

Common.Main
Common.Em_dash
SmartQuotes
ProtectQM

end sub



sub SmartQuotes
&apos; ----------------------------------------------------------------------
&apos; Replace primes by AE style quotation marks
&apos; ----------------------------------------------------------------------

Common.SmartQuotes(&quot;‘&quot;,&quot;’&quot;,&quot;“&quot;,&quot;”&quot;)

end sub



Sub TypewriterView
&apos; ----------------------------------------------------------------------
&apos; Keyboard glyphs only 
&apos; ----------------------------------------------------------------------

Revert.Prime
Revert.Ellipsis
Revert.Em_dash
Revert.UnprotectQM

End Sub



Sub ProtectQM
&apos; ----------------------------------------------------------------------
&apos; Prevent hyphenation around quotation marks
&apos; ----------------------------------------------------------------------

Common.ProtectQM(&quot;“&quot;,&quot;”&quot;)

End Sub



Sub UnprotectQM
&apos; ----------------------------------------------------------------------
&apos; Allow hyphenation around quotation marks
&apos; ----------------------------------------------------------------------

Common.UnprotectQM(&quot;“&quot;,&quot;”&quot;)

End Sub


sub ShowDirectSpeech
&apos; ----------------------------------------------------------------------
&apos; De-emphasize all but direct speech 
&apos; ----------------------------------------------------------------------

Common.ShowDirectSpeech(&quot;“[^“]+”&quot;)

end sub



sub StandardView
&apos; ----------------------------------------------------------------------
&apos; Set all text to default color
&apos; ----------------------------------------------------------------------

Common.StandardView

end sub




</script:module>